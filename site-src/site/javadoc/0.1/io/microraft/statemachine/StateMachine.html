<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.8) on Fri Sep 03 01:06:08 BST 2021 -->
<title>StateMachine (MicroRaft 0.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-09-03">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="StateMachine (MicroRaft 0.1 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6,"i2":6,"i3":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/StateMachine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">io.microraft.statemachine</a></div>
<h2 title="Interface StateMachine" class="title">Interface StateMachine</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public interface <span class="typeNameLabel">StateMachine</span></pre>
<div class="block">The abstraction used by <a href="../RaftNode.html" title="interface in io.microraft"><code>RaftNode</code></a> instances to execute operations on the user-supplied state machines.
 <p>
 Raft nodes do not deal with the actual logic of committed operations. Once a given operation is committed by Raft, i.e., it is
 replicated to the majority of the Raft nodes, the operation is passed to the given state machine implementation. It is the
 state machine implementation's responsibility to ensure deterministic execution of the committed operations. In other words, a
 committed operation must produce the same result independent of when or on which Raft node instance it is being executed.
 <p>
 The operations committed in a Raft node instance are run in the same thread that runs the tasks submitted by that Raft node
 instance. Since <a href="../executor/RaftNodeExecutor.html" title="interface in io.microraft.executor"><code>RaftNodeExecutor</code></a> ensures the thread-safe execution of the tasks submitted by a Raft node, state machine
 implementations do not need to be thread-safe.
 <p>
 A <a href="StateMachine.html" title="interface in io.microraft.statemachine"><code>StateMachine</code></a> implementation can implement <a href="../lifecycle/RaftNodeLifecycleAware.html" title="interface in io.microraft.lifecycle"><code>RaftNodeLifecycleAware</code></a> to perform initialization and clean up work
 during <a href="../RaftNode.html" title="interface in io.microraft"><code>RaftNode</code></a> startup and termination. <a href="../RaftNode.html" title="interface in io.microraft"><code>RaftNode</code></a> calls <a href="../lifecycle/RaftNodeLifecycleAware.html#onRaftNodeStart()"><code>RaftNodeLifecycleAware.onRaftNodeStart()</code></a> before
 calling any other method on <a href="StateMachine.html" title="interface in io.microraft.statemachine"><code>StateMachine</code></a>, and finally calls <a href="../lifecycle/RaftNodeLifecycleAware.html#onRaftNodeTerminate()"><code>RaftNodeLifecycleAware.onRaftNodeTerminate()</code></a> on
 termination.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../RaftNode.html" title="interface in io.microraft"><code>RaftNode</code></a>, 
<a href="../executor/RaftNodeExecutor.html" title="interface in io.microraft.executor"><code>RaftNodeExecutor</code></a>, 
<a href="../lifecycle/RaftNodeLifecycleAware.html" title="interface in io.microraft.lifecycle"><code>RaftNodeLifecycleAware</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getNewTermOperation()">getNewTermOperation</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the operation to be appended after a new leader is elected in a new term.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#installSnapshot(long,java.util.List)">installSnapshot</a></span>&#8203;(long&nbsp;commitIndex,
               <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&nbsp;snapshotChunks)</code></th>
<td class="colLast">
<div class="block">Installs the given snapshot chunks for the given commit index, which is same with the commit index on which the last
 snapshot is taken.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#runOperation(long,java.lang.Object)">runOperation</a></span>&#8203;(long&nbsp;commitIndex,
            <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;operation)</code></th>
<td class="colLast">
<div class="block">Executes the given operation on the state machine and returns result of the operation.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#takeSnapshot(long,java.util.function.Consumer)">takeSnapshot</a></span>&#8203;(long&nbsp;commitIndex,
            <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Consumer</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&nbsp;snapshotChunkConsumer)</code></th>
<td class="colLast">
<div class="block">Takes a snapshot of the state machine for the given commit index which is the current commit index at the local Raft node.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="runOperation(long,java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runOperation</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;runOperation&#8203;(long&nbsp;commitIndex,
                    <a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;operation)</pre>
<div class="block">Executes the given operation on the state machine and returns result of the operation.
 <p>
 Please note that the given operation must be deterministic and return the same result on all Raft nodes of the Raft group.
 <p>An operation is executed when it is replicated to the majority of
 the Raft group, hence committed. In addition to that, an operation can be replayed, i.e., executed again, if a Raft node
 crashes and restarts with persisting its internal state.
 <p>
 MicroRaft does not inform the state machines if the operation is being executed for the first time or replayed, and it is
 the state machine implementations' responsibility to ensure determinism in both cases. For instance, if a state machine
 implementation creates some side effects on operation execution, it can also persist the log index of the last executed
 operation so that replays do not cause duplicate side effects. Another option would be creating side effects idempotently,
 so that replays do not make any difference.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitIndex</code> - the Raft log index on which the given operation is committed</dd>
<dd><code>operation</code> - the user-supplied operation to be executed</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the result of the operation execution</dd>
</dl>
</li>
</ul>
<a id="takeSnapshot(long,java.util.function.Consumer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>takeSnapshot</h4>
<pre class="methodSignature">void&nbsp;takeSnapshot&#8203;(long&nbsp;commitIndex,
                  <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Consumer</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&nbsp;snapshotChunkConsumer)</pre>
<div class="block">Takes a snapshot of the state machine for the given commit index which is the current commit index at the local Raft node.
 <p>
 A snapshot must be immutable and must not change when new operations are executed on the state machine.
 <p>
 If a state machine implementation maintains a large state, it can divide its state into multiple chunks to help the local
 Raft node send the snapshot to the other Raft nodes in the group without overloading the system.
 <p>
 Once a follower falls behind the leader and requires to install a snapshot, it may fetch the latest snapshot chunks both
 from the leader and the other followers. Moreover, snapshot chunks can be sent one by one or multiple at one go to speed up
 the snapshot installation process. There is an important caveat here. State machine implementations must populate the
 snapshot chunks in a deterministic way, so that a slow follower always reaches to the same state with the Raft leader and
 other followers independent of from which nodes the chunks are fetched. If a state machine cannot create multiple snapshot
 chunks in a deterministic way, then it can create a single big snapshot chunk to disable optimization, or it can be
 directly disabled via <a href="../RaftConfig.html" title="class in io.microraft"><code>RaftConfig</code></a>. However, disabling this optimization can cause longer snapshot transfer durations
 since the bandwidth of followers is not utilized.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitIndex</code> - the commit index on which the current snapshot is being taken</dd>
<dd><code>snapshotChunkConsumer</code> - the consumer object to collect the snapshot chunks</dd>
</dl>
</li>
</ul>
<a id="installSnapshot(long,java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>installSnapshot</h4>
<pre class="methodSignature">void&nbsp;installSnapshot&#8203;(long&nbsp;commitIndex,
                     <a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
                     <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&nbsp;snapshotChunks)</pre>
<div class="block">Installs the given snapshot chunks for the given commit index, which is same with the commit index on which the last
 snapshot is taken. The snapshot chunks are in the order they are provided to the chunk consumer parameter of <a href="#takeSnapshot(long,java.util.function.Consumer)"><code>takeSnapshot(long, Consumer)</code></a> method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>commitIndex</code> - the commit index on which the given snapshot is taken</dd>
<dd><code>snapshotChunks</code> - the list of snapshot chunk provided by the state machine when the snapshot is taken</dd>
</dl>
</li>
</ul>
<a id="getNewTermOperation()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getNewTermOperation</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;getNewTermOperation()</pre>
<div class="block">Returns the operation to be appended after a new leader is elected in a new term.
 <p>
 See <a href="https://groups.google.com/forum/#!msg/raft-dev/t4xj6dJTP6E/d2D9LrWRza8J">
 <i>Bug in single-server membership changes</i></a> post by Diego Ongaro
 for more information.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the operation to be appended after a new leader is elected in a new term.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/StateMachine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2021 <a href="https://microraft.io/">MicroRaft</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
